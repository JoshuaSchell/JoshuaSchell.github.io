---
import { getCollection } from 'astro:content';

const posts = await getCollection('blog', ({ data }) => !data.draft);
const recentPosts = posts
  .sort((a, b) => b.data.publishedDate.getTime() - a.data.publishedDate.getTime())
  .slice(0, 3);
---

<section class="animate-fade-in">
  <h2 class="section-title">// blog</h2>
  <div class="space-y-2">
    {recentPosts.map((post) => (
      <a
        href={`/blog/${post.id}`}
        class="flex items-center justify-between group p-2 -mx-2 rounded hover:bg-muted/50 transition-colors"
      >
        <span class="font-medium group-hover:text-accent transition-colors link-underline">
          {post.data.title}
        </span>
        <span class="text-sm text-foreground/50">
          {post.data.publishedDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })}
        </span>
      </a>
    ))}
  </div>
  <a
    href="/blog"
    class="group flex items-center gap-1 p-2 -mx-2 rounded hover:bg-muted/50 transition-colors mt-4 text-sm text-accent"
  >
    all posts
    <span class="inline-block opacity-0 -translate-x-1 group-hover:opacity-100 group-hover:translate-x-0 transition-all duration-200">â†’</span>
  </a>
</section>
